---
layout:     post
title:      哈希表
subtitle:   HashMap
date:       2019-11-27
author:     BY
header-img: img/post-bg-cook.jpg
catalog: true
tags:
    - java
---

### 文件搜索系统

* 所用技术:JavaFX，多线程，SQLite，pinyin4j
* 平台与环境：Windows，IDEA，Maven
* 项目功能：指定搜索目录，显示目录中的所有文件，文件夹信息，并使用多线程进行文件扫描，并且将文件信息
  保存在数据库中，若本地文件进行了修改，则会与数据库信息进行比对，将本地信息更新到数据库中
* 可以支持中英文检索、首字母缩写、模糊查询

> 项目设计流程

https://github.com/q1206271031/photo/raw/master/%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2%E7%B3%BB%E7%BB%9F/%E9%A1%B9%E7%9B%AE%E6%B5%81%E7%A8%8B.png
  
> 本地文件与数据库文件对比流程

https://github.com/q1206271031/photo/raw/master/%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2%E7%B3%BB%E7%BB%9F/%E6%96%87%E4%BB%B6%E5%AF%B9%E6%AF%94%E6%B5%81%E7%A8%8B.png
 
> Pinyin4j介绍

* 是一个Java的内库，提供对中文汉字到拼音的转换
* 存在多音字的情况，根据一个字符可以获取多个字符串

```java
String[] pinyins = PinyinHelper.toHanyuPinyinStringArray('长');
```
 
    输出：
    [zhang3, chang2]

* 可以配置输出格式，包括大小写、是否带音调（默认带）、是否使用v（如绿的拼音lv)

#### 代码

> pinyin4jUtil

```java
import net.sourceforge.pinyin4j.PinyinHelper;
import net.sourceforge.pinyin4j.format.HanyuPinyinCaseType;
import net.sourceforge.pinyin4j.format.HanyuPinyinOutputFormat;
import net.sourceforge.pinyin4j.format.HanyuPinyinToneType;
import net.sourceforge.pinyin4j.format.HanyuPinyinVCharType;

import java.lang.reflect.Array;
import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;
public class Pinyin4jUtil {
    //配置汉字的字符范围
    private static final String CHINESE_PATTERN = "[\\u4E00-\\u9FA5]";

    private static final HanyuPinyinOutputFormat FORMAT = new HanyuPinyinOutputFormat();
    //初始化
    static {
        //设置小写
        FORMAT.setCaseType(HanyuPinyinCaseType.LOWERCASE);
        //设置不带音调
        FORMAT.setToneType(HanyuPinyinToneType.WITHOUT_TONE);
        //设置v字符
        FORMAT.setVCharType(HanyuPinyinVCharType.WITH_V);
    }
    /*1.取每一个汉字的拼音的第一个然后拼接在一起返回
     *
     * */
    public static String[] get(String hanyu){
        String[] array = new String[2];
        //全拼
        StringBuilder pinyin = new StringBuilder();
        //拼音首字母
        StringBuilder pinyin_first = new StringBuilder();
        for (int i = 0; i <hanyu.length() ; i++) {
            try {
                String[] pingyin = PinyinHelper.
                        toHanyuPinyinStringArray(hanyu.charAt(i),FORMAT);
                //中文字符返回的字符串数组，可能为null或者长度为0.
                //返回原始数值
                if (pingyin.length==0 || pingyin==null){
                    //假如拼接英文和数字，加原始字符
                    pinyin.append(hanyu.charAt(i));
                    pinyin_first.append(hanyu.charAt(i));
                }else {
                    //可以转换为拼音，只取第一个返回
                    pinyin.append(pingyin[0]);
                    //第一个拼音的第一个字符
                    pinyin_first.append(pingyin[0].charAt(0));
                }
            } catch (Exception e) {
                //出现异常返回原始字符
                pinyin.append(hanyu.charAt(i));
                pinyin_first.append(hanyu.charAt(i));
            }
        }
        array[0] = pinyin.toString();
        array[1] = pinyin_first.toString();
        return array;
    }
    /*
     * 返回所有字符串拼音
     * 排列组合
     * hanyu 字符串
     * fullSpell 是否为全拼
     * */
    public static String[][] get(String hanyu,boolean fullSpell){
        String[][] result = new String[hanyu.length()][];
        for (int i = 0;i < hanyu.length();i++) {
            try {
                String[] pinyins = PinyinHelper.
                        toHanyuPinyinStringArray(hanyu.charAt(i),FORMAT);
                //中文字符返回的字符串数组，可能为null或者长度为0.
                //返回第i行原始字符
                if (pinyins.length==0 || pinyins==null){//a->["a"]
                    //二维元素的某一行
                    result[i] = new String[]{String.valueOf(hanyu.charAt(i))};
                }else {//和he he
                    //可以转换为拼音，只取第一个返回
                    result[i] = unique(pinyins, fullSpell);
//                    //只去重
//                    Set<String> set = new HashSet<>();
//                    set.addAll(Arrays.asList(pinyins));
//                    result[i] = set.toArray(new String[set.size()]);
                }
            } catch (Exception e) {
                //出现异常返回原始字符
                result[i] = new String[]{String.valueOf(hanyu.charAt(i))};
            }
        }
        return result;
    }
    /*
     * 拼字符串
     * 全拼就是拼音，非全拼就是首字母
     * */
    private static String[] unique(String[] pinyins, boolean fullSpell) {
        Set<String> set = new HashSet<>();
        for (int i = 0; i < pinyins.length ; i++) {
            if (fullSpell){
                set.add(pinyins[i]);
            }else {
                set.add(String.valueOf(pinyins[i].charAt(0)));
            }
        }
        return set.toArray(new String[set.size()]);
    }

    public static void main(String[] args)  {
        String[] pingyins = get("中华人民共和国");
        System.out.println(Arrays.toString(pingyins));
        for (String[] s : get("中华人a民1共和国", true)) {
            System.out.println(Arrays.toString(s));
        }
//        System.out.println(containsChinese("abc")); //false
//        System.out.println(containsChinese("a闪c")); //true
    }


    public static boolean containsChinese(String str){
        return str.matches(".*" + CHINESE_PATTERN + ".*");

    }
}
```

    第一个get方法是获取到每个汉字转拼音后的全拼+首字母缩写
    第二个方法直接拼接去重后的原字符串，如果遇到非汉字，直接打印原字符串
    其中汉字的字符集范围为[\\u4E00-\\u9FA5]


 


















